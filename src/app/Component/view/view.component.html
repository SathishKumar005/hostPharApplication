<div class="bb-view">
  <div class="bb-in">
    <div class="bb-intwo">
      <button class="back-button" (click)="goBack()">
        <img
          src="https://icons.iconarchive.com/icons/fa-team/fontawesome/128/FontAwesome-Reply-icon.png"
          width="20"
          height="20"
        />
        <span class="sp">Back</span>
      </button>
    </div>
    <h2><span>Billed Data</span></h2>
  </div>
  <div class="view-out">
    <div class="billed-data-container">
      <table>
        <thead>
          <tr>
            <th>ID</th>
            <th>Customer Name</th>
            <th>Customer Number</th>
            <th>Final Amount</th>
            <th>Billed Date</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let bill of bills; let i = index">
            <td>{{ i + 1 }}</td>
            <td>{{ bill.customerName }}</td>
            <td>{{ bill.customerNumber }}</td>
            <td>{{ bill.finalAmount | number : "1.2-2" }}</td>
            <!-- <td>{{ bill.billedDate | date : "short" }}</td> -->
             <td>{{ bill.billedDate | date:'MM/dd/yy, hh:mm a' }}</td>

            <td>
              <button class="aa"(click)="viewDetails(bill.viewDetails)">
                View Details
              </button>
            </td>
          </tr>
        </tbody>
      </table>

      <!-- Modal for Viewing Details -->
      <div class="modal-overlay" *ngIf="selectedDetails">
        <div class="modal-content">
          <button class="modal-close" (click)="closeDetails()">×</button>
          <h3>Bill Details</h3>
          <table class="modal-table">
            <thead>
              <tr>
                <th>Item Name</th>
                <th>Quantity</th>
                <th>Total Amount</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let item of selectedDetails">
                <td>{{ item.itemName }}</td>
                <td>{{ item.quantity }}</td>
                <td>{{ item.totalAmount | number : "1.2-2" }}</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
    <div class="view-in">
      <div class="billed-target">
        <h3>This Month's Billed Amount</h3>
        <div class="meter-container">
          <!-- Curved Meter (SVG) -->
          <svg viewBox="0 0 100 50" class="curved-meter">
            <!-- Background Arc -->
            <path d="M 10 40 A 40 40 0 0 1 90 40" class="background-arc"></path>
            <!-- Progress Arc -->
            <path
              d="M 10 40 A 40 40 0 0 1 90 40"
              class="progress-arc"
              [attr.stroke-dasharray]="progressDashArray"
              [attr.stroke-dashoffset]="progressDashOffset"
            ></path>
          </svg>
          <div class="meter-labels">
            <p>
              <strong>Total Billed:</strong> ₹{{
                totalBilledAmount | number : "1.2-2"
              }}
            </p>
            <p><strong>Target:</strong> ₹{{ defaultTarget }}</p>
          </div>
        </div>
      </div>

      <div class="low-stock-container">
        <h3>Low Stock Items</h3>
        <table class="t2">
          <thead>
            <tr>
              <th>ID</th>
              <th>Name</th>
              <th>Quantity</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let item of lowStockItems; let i = index">
              <td>{{ i + 1 }}</td>
              <td>{{ item.productName }}</td>
              <td class="td-red">{{ item.quantity }}</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>
